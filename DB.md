# Базы данных I курс

Сугоняк Инна Ивановна

<!--

org_sii@ztk.edu.ua

Inna Sygonyak
+380504631737

-->

<hr />

*02.09.2020*

SQL:
- MS SQL
- Oracle

MS SQL Server Developer Edition

MS SQL Server Management Studio (SSMS)

MySQL:
- WorkBench
- Navicat


Распределение баллов:
- Лекция - 0
- ЛР - 8
- Тест - 10
- КР - 20

Для получения доступа к тестам нужнл сделать 4 лабы + КР

## Базы данных

Понятия: Data Warehouse, Data Storage, Абстракция данных, Транзакция

СУБД отправляет 404 при отсутствии доступа

Модель
- ВВнешняя модель
Конё


Data-логические модели БД:
- Иерархические
- Реляционные
- Сетевые
- Объёктно-ориентированные

Data-логическая модель определяет модель СУБД.

Физические модели:
- Файловые структуры - файл-отдельный объект СУБД
  - Access
  - NoSQL
- Странично-сегментная организация - изначально выделяется 8 страниц, позволяет создавать неограниченные по размеру БД. Поддерживает распределение.
  - Extend'ы бывают
    - Смешанные
    - Однородные/изолированные
  - Используется во всех современных SQL СУБД

> Entity Relationship Diagram (ER диаграмма/ERD/сущность-связь) — модель связи данных


- Теоретические множества:
  - Реляционные БД
- Графовые:
  - Сетевые БД
    - Иерархические БД

Типы отношений:
- 1-1
- 1-∞
- ∞-∞ - Для разрешения требуется создание дополнительных таблиц (не поддерживается в иерархических моделях)

Нотация Чена
- Существа - прямоугольники
- Действия - ромбы
- Минус - слишком большой объём данных в более-менее большой БД

Нотация Баркера
- Типичная Draw.io
- Типы связи:
  - `-----<`
  - `----|-`
  - `----()`

ER модели в основном строятся в:
- СУБД
- Графические/ER редакторы

Некоторые редакторы позволяют генерировать SQL запрос по генерации БД по построенной ER диаграмме, а так же проводить реверс-инжиниринг по готовой БД.
- Offusion Data Model/Erwin
- PowerDesigner
- ER/Studio
- Visible Analyst
- Visio Enterprise
- SQL Developer Data Model

> Предметная область - определённая часть реального мира.

> Модель данных - концептуальныое описание БД.

Никогда в БД не может быть таблицы с одним полем

Связей всегда должно быть меньше, чем таблиц.

Ловушка розгалуження <!-- TODO: вставить картинку -->

Ловушка разрыва - единственный случай, когда количество связей = количеству таблиц


- `---|1` - Тут конкретный объект быдет всегда
- `---|0` - тут может быть или не быть конкретный объект

<hr />

*11.09.2020*

> Атрибут - Характеристика (общая для всех объеков мертика, имеющая у каждого своё значение)

> Метрика - Значение атрибута

> BLOB (Binary Large Object)

> Домен атрибута - Объединение типа данных и бизнес ограничений на значения

> Data-логическое проектирование

1. Концептуальное проектирование
2. Data-логическое проектирование
3. Физическое проектирование

### Свойства отношений

|Реляционные БД|ERD|MS Access|
|---|---|---|
|Отношение|Сущность|Раблица|
|Кортеж|Запись|Строка|
|Атрибут|Характеристика|Столбец|

> Кортеж - совокупность атрибутов со значениями, относящихся к одному объекту СУБД

Свойства отношений:
- Кортежи не повторяюся
- Порядок следования кортежей не важен
- Отношения не может содержать несколько одинаковых атрибутов
- Значения атрибутов для каждого экземпляра сущности должны соответствовать домену атрибута или NULL
- Отношения не могут иметь одинаковые имена

> На пересечении строки и колонки есть лишь одно значение

> NULL - Значение не отвечает домену атрибута или не существует

Внешний ключ добавляется в таблицу для определения подключаемых значений и должен иметь значение перечесления первичного ключа или NULL (keyof Table.primary | NULL)

Ключи
- Первичный ключ (Primary Key)
  - Природные
    - Суперключ - Всё множество полей, делающих запись уникальной
    - Потенциальный ключ - Минимально возможное множество атрибутов, делающих запись уникальной
  - Искусственные - Не имеющие логическое обоснование, дающие уникальность (не повторяются в конкретной таблице)
- Внешний ключ (Foreign Key)


- Первая нормальная форма - На пересечении лишь одно значение (создание повторяющихся полей) | Вынесение того, что не относится конкретно к объекту`
- Вторая нормальная форма - Вынесение повторяющихся данных в отдельную таблицу | Есть есть искусственный ключ, таблица **уже во второй нормальной форме**
- Третья нормальная форма - Уничтожение транзитивных зависимостей (???)

> Транзитивная зависимость - зависимость атрибута А через атрибут Б. Должность зависит от ФИО. Зарплата зависит от должности. Зарплата не зависит от ФИО. Создаём таблицу Должность-Зарплата.

**Нормализация, в основном, выполняется до третьей нормальной формы**

> Неполная функциональная зависимость - зависимость от части первичного ключа

<hr />

*18.09.2020*

Языки баз данных:
- По назначению
  - DDL - Data Definition Language
    - SQL: CREATE, ALTER, DROP
  - DML - Data Manipulation Language
    - SELECT, INSERT UPDATE, DELETE
  - DAL - Data Access Language

> 4GL (4 Generation Language) - Визуальные конструктуры

Языки программирования бывают
- Алгоритмические
- Процедурные (SQL)
- Разметки

> SQL - процедурный язык программирования

> CREATE DATABASE лишь копирует базу данных model под новым именем


Команды
```
USE *name* // Переключение на БД

CREATE DATABASE *name* // Создание новой БД

CREATE TABLE *name* (*colname* *type* *(size)?*) *constraints* // Создание таблицы
```

Constraints (ограничения):
- NOT NULL
- UNIQUE - Значение для разных строк не могут повторятся
  - UNIQUE *attr1*, *attr2* // attr1 + attr2 не могут повторятся
- CHECK (*condition*) // Задание условия проверки
- DEFAULT = '' // Значение по умолчанию
- PRIMARY KEY // Только для NOT NULL, ставит кластерный индекс
  - PRIMARY KEY (*attr1*, *attr2*) // Для нескольких полей
- REFERENCES (*table*(*attr*))


Trigger functions:
- IDENTITY(start, step) // = start; += step при **попытке** вставки данных // INT, DECIMAL, BILLING

Functions:
- NEWID() - На основе MAC адреса и на основе предыдущего GUID
- NEWSEQUENTIALID() - На основе предыдущего GUID [Recommended]

Варианты обновления данных:
- CASCADE
- RESTRICTED
- SET NULL
- SET DEFAULT
- NO ACTION


GUID (Global Unique Identifier) - 128 битовый (XXXXXXXX-...)

Кодомусор:

```
create table mainTab
    idmainTab int not null identity(1,1) primary key,
    pole1 varchar(50),
    pole3 date default=getdate(),
    pole4 int check pole 4 > 5),
    pole5 dеcimal(3,2) // 3 цифры, 2 после запятой, слева 3-2
)

select * from mainTab

# Invalid
insert into mainTab
values (!!1!!, 'tsetset', '01/01/2000'/'01.01.2000'/'01-01-2000', !!3!!, 34.5) # month-day-year

# Valid
insert into mainTab ([pole1], [pole3], [pole4], [pole5])
values ('tsetset', '01/01/2000'/'01.01.2000'/'01-01-2000', 6, 34.5) # month-day-year

select '2'+3 # 5
select '2f'+case(3 as char(5)) -- Явное приведение типов

...
idmainTab int not null
constraint fk_mainTab
    foreign key(idmainTab)
        references mainTab(idmainTab)
        on delete cascade on update cascade

alter table slaveTab
    add constraint fk_mainTab
        foreign key(idmainTab)
            references mainTab(idmainTab)

```


## Шутки

> Вы что-то слышали о социальном дистанцировании? Не задевай ближнего локтями


